## Java 21
 sudo apt update
sudo apt install -y wget apt-transport-https gnupg
wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public | sudo gpg --dearmor -o /usr/share/keyrings/adoptium.gpg

echo "deb [signed-by=/usr/share/keyrings/adoptium.gpg] https://packages.adoptium.net/artifactory/deb $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/adoptium.list
sudo apt update
sudo apt install -y temurin-21-jdk

-------------------------------------------
 java --version
openjdk 21.0.9 2025-10-21 LTS
OpenJDK Runtime Environment Temurin-21.0.9+10 (build 21.0.9+10-LTS)
OpenJDK 64-Bit Server VM Temurin-21.0.9+10 (build 21.0.9+10-LTS, mixed mode, sharing)
-----------------------------------------------
## Jenkins-installation ###
sudo apt update -y
sudo apt install openjdk-17-jdk -y
sudo apt update -y
sudo apt install maven -y
curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key | sudo tee \
  /usr/share/keyrings/jenkins-keyring.asc > /dev/null
echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \
  https://pkg.jenkins.io/debian-stable binary/ | sudo tee \
  /etc/apt/sources.list.d/jenkins.list > /dev/null
sudo apt update -y
sudo apt install jenkins -y
service jenkins start

sudo cat /var/lib/jenkins/secrets/initialAdminPassword

sudo systemctl restart jenkins
http://13.235.17.168:8080/
---Plugin--------
STEP 3 â€” Install Prometheus Jenkins Plugin
On the Jenkins UI:
Manage Jenkins â†’ Plugins â†’ Available â†’ Search Prometheus Metrics Plugin â†’ Install â†’ Restart
Enable the endpoint:
Manage Jenkins â†’ Configure System â†’ Prometheus
âœ”ï¸ Enable
ğŸ“ Endpoint: /prometheus
Verify metrics:
http://<jenkins-ip>:8080/prometheus


http://13.235.17.168:8080/prometheus/
--------------------------------------------------------------------------
cd /opt
################node exporter ###########
Node Exporter â€” Full Install Guide (Ubuntu / Debian)

Assumes you have sudo on the machine and want node_exporter to run as a systemd service on port 9100.

1) Download the latest release
cd /tmp
# Using GitHub "latest" download link (safe pattern)
wget https://github.com/prometheus/node_exporter/releases/latest/download/node_exporter-*.linux-amd64.tar.gz
tar -xf node_exporter-*.linux-amd64.tar.gz


If you prefer to pick a specific version, replace latest with the tag (e.g. v1.10.2) in the URL.

2) Move binary to a global location
sudo mv node_exporter-*/node_exporter /usr/local/bin/
sudo chmod 755 /usr/local/bin/node_exporter

3) Create a dedicated user (non-login) and group
sudo useradd --no-create-home --shell /usr/sbin/nologin --system node_exporter
# or (older systems)
# sudo useradd --no-create-home --shell /bin/false node_exporter

4) Set ownership (optional but tidy)
sudo chown node_exporter:node_exporter /usr/local/bin/node_exporter

5) Create systemd service file
sudo tee /etc/systemd/system/node_exporter.service > /dev/null <<'EOF'
[Unit]
Description=Node Exporter
Wants=network-online.target
After=network-online.target

[Service]
User=node_exporter
Group=node_exporter
Type=simple
ExecStart=/usr/local/bin/node_exporter \
  --web.listen-address=:9100 \
  --web.telemetry-path=/metrics
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOF

6) Reload systemd, enable & start
sudo systemctl daemon-reload
sudo systemctl enable --now node_exporter
sudo systemctl status node_exporter   # should show Active: active (running)

7) Verify itâ€™s working locally
curl http://localhost:9100/metrics | head -n 20
# or from another machine:
curl http://<server-ip>:9100/metrics
http://<jenkins-ip>:9100/metrics
---------------------
###############3Prometheus################3
 wget https://github.com/prometheus/prometheus/releases/download/v2.34.0/prometheus-2.34.0.linux-amd64.tar.gz

 ls
prometheus-2.34.0.linux-amd64.tar.gz
ubuntu@ip-172-31-33-160:~$ tar zxvf prometheus-2.34.0.linux-amd64.tar.gz

 ls
prometheus-2.34.0.linux-amd64  prometheus-2.34.0.linux-amd64.tar.gz
ubuntu@ip-172-31-33-160:~$ cd prometheus-2.34.0.linux-amd64/
ubuntu@ip-172-31-33-160:~/prometheus-2.34.0.linux-amd64$ ls
LICENSE  console_libraries  prometheus      promtool
NOTICE   consoles           prometheus.yml

###edit prometheus.yml file
 - job_name: 'node_exporter'
    static_configs:
      - targets: ['localhost:9100']

  - job_name: 'jenkins'
    metrics_path: /prometheus
    scrape_interval: 10s
    static_configs:
      - targets: ['localhost:8080']


######
./prometheus
http://13.235.17.168:9090/                     ## prometheus

#####################
Grafana machine:
wget https://dl.grafana.com/enterprise/release/grafana-enterprise-8.4.4.linux-amd64.tar.gz
ls
tar -zxvf grafana-enterprise-8.4.4.linux-amd64.tar.gz
ls
cd grafana-8.4.4
./bin/grafana-server

http://13.235.17.168:3000/
login: admin/admin

---------------------------------------------------------------###########
Add Prometheus Data Source in Grafana
Grafana â†’ Settings â†’ Data Source â†’ Prometheus
URL:
http://<prometheus-ip>:9090
Click Save & Test â†’ should turn green.
________________________________________

############3
Inside grafana dashboards
add panel

ğŸ§± Step 1: Create a New Dashboard

Open Grafana

Click Dashboards â†’ New â†’ New Panel

Select Prometheus as data source

ğŸ“Š Panel 1 â€” CPU Utilization (%)

Query:

100 - (avg by(instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)


Settings:

Unit: Percentage (%)

Visualization: Gauge or Time Series

Set thresholds:

Green: 0â€“60%

Yellow: 60â€“80%

Red: 80â€“100%

Name it:

Jenkins: CPU Usage
----------------------------------------------------------------------------------------
ğŸ“Š Panel 2 â€” CPU Load Average
avg(rate(node_cpu_seconds_total[1m])) without (mode)

--Good to know if builds are overloading the server.
----------------------------------------------------------------------------------------
ğŸ“Š Panel 3 â€” Memory Utilization (%)
(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) 
/ node_memory_MemTotal_bytes * 100


Format: Percentage (%)

Threshold hints:

Green: 0â€“70%

Yellow: 70â€“85%

Red: 85â€“100%

Name:

Jenkins: Memory Usage
----------------------------------------------------------------------------------------
ğŸ“Š Panel 4 â€” Memory Breakdown (Used vs Free)

Used memory:

node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes


Free memory:

node_memory_MemAvailable_bytes


Visualization: Stacked Bar / Time Series
----------------------------------------------------------------------------------------
ğŸ“Š Panel 5 â€” Disk Usage

(Useful because Jenkins eats storage)

(1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) * 100


Name:

Root Disk Usage (%)
---------------------------------------------------------------------

PAnel new: jenkins
default_jenkins_builds_available_builds_count{jenkins_job="project1"}   --> query

